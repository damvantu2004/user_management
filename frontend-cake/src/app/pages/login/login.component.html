<div style="background: #f0f5f9;min-height: 100vh;">
    <div class="container">
        <div class="auth-card p-4">
            <ul class="nav nav-tabs mb-3" id="authTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="login-tab" type="button" role="tab" (click)="switchTab('login')"
                        [ngClass]="{'active': activeTab === 'login'}">
                        ƒêƒÉng nh·∫≠p
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="register-tab" type="button" role="tab" (click)="switchTab('register')"
                        [ngClass]="{'active': activeTab === 'register'}">
                        ƒêƒÉng k√Ω
                    </button>
                </li>
            </ul>

            <div class="tab-content" id="authTabContent">
                <div *ngIf="message.status" class="alert alert-danger">
                    {{message.message}}
                </div>
                <div *ngIf="!message.status && message.clicked" class="alert alert-success">
                    {{message.message}}
                </div>
                <!-- ƒêƒÉng nh·∫≠p -->
                <div class="tab-pane fade" id="login" role="tabpanel"
                    [ngClass]="{'show active': activeTab === 'login'}">
                    <form #login="ngForm" (ngSubmit)="onLogin(login)">
                        <div class="mb-3">
                            <label for="loginEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="loginEmail" placeholder="nhap@email.com"
                                autocomplete [(ngModel)]="model.email" name="email" #name="ngModel" required email>
                            <div *ngIf="name.touched">
                                <p *ngIf="name.errors?.['required']" class="text-danger">Y√™u c·∫ßu nh·∫≠p email</p>
                                <p *ngIf="name.errors?.['email']" class="text-danger">Email kh√¥ng h·ª£p l·ªá</p>
                            </div>

                        </div>
                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">M·∫≠t kh·∫©u</label>
                            <input type="password" class="form-control" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                autocomplete="current-password" [(ngModel)]="model.password" name="password"
                                #password="ngModel" minlength=6 required>
                            <div *ngIf="password.touched">
                                <p *ngIf="password.errors?.['required']" class="text-danger">Y√™u c·∫ßu nh·∫≠p m·∫≠t kh·∫©u</p>
                                <p *ngIf="password.errors?.['minlength']" class="text-danger">M·∫≠t kh·∫©u l·ªõn h∆°n 6 k√≠ t·ª±
                                </p>
                            </div>

                        </div>
                        <div class="d-flex justify-content-between mb-3">
                            <div>
                                <input type="checkbox" [(ngModel)]="model.remember" name="remember"> remember
                                me
                            </div>
                            <a routerLink="/send-email">Qu√™n m·∫≠t kh·∫©u?</a>
                        </div>
                        
                        <!-- Widget reCAPTCHA v2 cho ƒëƒÉng nh·∫≠p -->
                        <div class="mb-3">
                            <div id="login-captcha" class="g-recaptcha" 
                                data-sitekey="6LfweSkrAAAAAIY0vALyQjfGCMHAsHLyKE27oEXz">
                            </div>
                            <div *ngIf="captchaError" class="text-danger mt-2">
                                Vui l√≤ng x√°c nh·∫≠n b·∫°n kh√¥ng ph·∫£i robot
                            </div>
                        </div>
                        
                        <button class="btn btn-custom w-100" type="submit" [disabled]="login.invalid">ƒêƒÉng nh·∫≠p</button>
                    </form>
                </div>

                <!-- ƒêƒÉng k√Ω -->
                <div class="tab-pane fade" [ngClass]="{'show active': activeTab === 'register'}" id="register"
                    role="tabpanel">
                    <form #register="ngForm" (ngSubmit)="onRegister(register)">
                        <div class="mb-3">
                            <label for="regName" class="form-label">H·ªç t√™n</label>
                            <input type="text" class="form-control" id="regName" placeholder="Nguy·ªÖn VƒÉn A"
                                #name1="ngModel" [(ngModel)]="modelRegister.name" name="name" required>
                            <div *ngIf="name1.touched">
                                <p *ngIf="name1.errors?.['required']" class="text-danger">Y√™u c·∫ßu nh·∫≠p h·ªç t√™n</p>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="regEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="regEmail" placeholder="nhap@email.com"
                                #email1="ngModel" [(ngModel)]="modelRegister.email" name="email" autocomplete required
                                email>

                            <div *ngIf="email1.touched">
                                <p *ngIf="email1.errors?.['required']" class="text-danger">Y√™u c·∫ßu nh·∫≠p email</p>
                                <p *ngIf="email1.errors?.['email']" class="text-danger">Email kh√¥ng h·ª£p l·ªá</p>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="regPhone" class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                            <input type="tel" class="form-control" id="regPhone" placeholder="0901234567"
                                #phone="ngModel" [(ngModel)]="modelRegister.phone" name="phone" required 
                                pattern="^[0-9]{10,11}$">
                            <div *ngIf="phone.touched">
                                <p *ngIf="phone.errors?.['required']" class="text-danger">Y√™u c·∫ßu nh·∫≠p s·ªë ƒëi·ªán tho·∫°i</p>
                                <p *ngIf="phone.errors?.['pattern']" class="text-danger">S·ªë ƒëi·ªán tho·∫°i ph·∫£i c√≥ 10-11 ch·ªØ s·ªë</p>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="regPassword" class="form-label">M·∫≠t kh·∫©u</label>
                            <input type="password" class="form-control" id="regPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                #password1="ngModel" [(ngModel)]="modelRegister.password" autocomplete="new-password"
                                name="password" required minlength=6>
                            <div *ngIf="password1.touched">
                                <p *ngIf="password1.errors?.['required']" class="text-danger">Y√™u c·∫ßu nh·∫≠p m·∫≠t kh·∫©u</p>
                                <p *ngIf="password1.errors?.['minlength']" class="text-danger">M·∫≠t kh·∫©u l·ªõn h∆°n 6 k√≠ t·ª±
                                </p>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="retypePassword" class="form-label">Nh·∫≠p l·∫°i m·∫≠t kh·∫©u</label>
                            <input type="password" class="form-control" id="retypePassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                #password_confirmation="ngModel" [(ngModel)]="modelRegister.password_confirmation"
                                name="password_confirmation" autocomplete="new-password">
                            <p *ngIf="password_confirmation.touched && !passwordMatching()" class="text-danger">M·∫≠t kh·∫©u
                                kh√¥ng
                                kh·ªõp</p>
                        </div>
                        
                        <!-- Widget reCAPTCHA v2 cho ƒëƒÉng k√Ω -->
                        <div class="mb-3">
                            <div id="register-captcha" class="g-recaptcha" 
                                data-sitekey="6LfweSkrAAAAAIY0vALyQjfGCMHAsHLyKE27oEXz">
                            </div>
                            <div *ngIf="captchaError" class="text-danger mt-2">
                                Vui l√≤ng x√°c nh·∫≠n b·∫°n kh√¥ng ph·∫£i robot
                            </div>
                        </div>
                        
                        <!-- Role Selection -->
                        <div class="mb-3">
                            <label for="role" class="form-label">ƒêƒÉng k√Ω v·ªõi vai tr√≤</label>
                            <select class="form-control" id="role" [(ngModel)]="modelRegister.role" name="role" required>
                                <option value="patient">üè• B·ªánh nh√¢n</option>
                                <option value="doctor">üë®‚Äç‚öïÔ∏è B√°c sƒ©</option>
                            </select>
                            <small class="text-muted">Ch·ªçn vai tr√≤ ph√π h·ª£p v·ªõi b·∫°n</small>
                        </div>
                        
                        <button type="submit" class="btn btn-custom w-100"
                            [disabled]="register.invalid || !passwordMatching()">ƒêƒÉng k√Ω</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
@if (loading) {
<app-loading></app-loading>
}
